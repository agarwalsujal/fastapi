# Insurance Premium Category Predictor

DEMO FastAPI + Streamlit project for training a classifier to predict insurance premium categories based on user features. The project includes a notebook for training, a FastAPI backend for predictions, and a Streamlit frontend for interactive use.

**Key Features**

- **Train**: `fastapi_ml_model.ipynb` — prepares features, trains a RandomForest pipeline, and saves `model.pkl`.
- **API**: `app.py` — FastAPI app exposing `/predict` that accepts user details and returns a predicted premium value.
- **Demo frontend**: `frontend.py` — Streamlit UI that posts input to the API and displays results.

**Files**

- `app.py` — FastAPI server that loads `model.pkl` and exposes `/predict`.
- `main.py` — sample Patients API demonstrating Pydantic models and CRUD operations (not related to the ML model).
- `frontend.py` — Streamlit UI for making prediction requests.
- `fastapi_ml_model.ipynb` — notebook used to preprocess data, train the pipeline, and save `model.pkl`.
- `insurance.csv` — dataset used by the notebook.
- `model.pkl` — trained pipeline used by `app.py` (generated by the notebook).

Requirements

- Python 3.11+ recommended.
- Pydantic v2 (for `computed_field`) and the usual ML stack.

Quick setup (Windows)

1. Create / activate virtualenv (optional):
   - PowerShell: `.\\myenv\\Scripts\\Activate.ps1`
   - CMD: `.\\myenv\\Scripts\\activate.bat`

2. Install dependencies:

   ```bash
   pip install fastapi uvicorn[standard] streamlit scikit-learn pandas numpy requests
   ```

Run the backend (FastAPI)

```bash
uvicorn app:app --reload --host 127.0.0.1 --port 8000
```

Run the frontend (Streamlit)

```bash
streamlit run frontend.py
```

API usage (example)

POST `http://127.0.0.1:8000/predict`

Payload example:

```json
{
  "age": 30,
  "weight": 75.0,
  "height": 1.7,
  "income": 10.0,
  "smoker": "no",
  "city": "Mumbai",
  "occupation": "private_job"
}
```

The FastAPI app computes `bmi`, `age_group`, `lifestyle_risk`, and `city_tier` via Pydantic `computed_field`s and passes engineered features to the saved pipeline.

Retraining the model

- Open `fastapi_ml_model.ipynb`, ensure `insurance.csv` is present, run cells to train the `pipeline`, and re-run the cell that saves `model.pkl`.

Notes & Troubleshooting

- If you see validation issues, confirm you are using Pydantic v2 and Python 3.11+.
- If the frontend can't reach the API, confirm the backend is running at `127.0.0.1:8000` and no firewall is blocking the port.

License & Contact

- This repository is provided as-is for learning and prototyping. Contact the maintainer for questions or improvements.
